---
title: Multi-Project Coordination
description: Coordinate agents across multiple repositories using bridge mode
---

# Multi-Project Coordination

Agent Relay enables agents across different repositories to communicate seamlessly. This guide covers setting up and using bridge mode for multi-project workflows.

## Use Case

Consider a typical microservices architecture:

```
Organization: Acme Corp
+-- acme/frontend    (React app)
+-- acme/backend     (Express API)
+-- acme/shared-lib  (TypeScript utilities)
```

With Agent Relay, agents working on each repository can coordinate changes that span all three projects.

## Architecture Overview

```
+---------------------------------------------------------------------+
|                    MULTI-PROJECT ARCHITECTURE                        |
|                                                                      |
|  Project: frontend          Project: backend          Project: libs  |
|  +-----------------+       +-----------------+       +------------+  |
|  |     Broker      |       |     Broker      |       |   Broker   |  |
|  |  +-----+ +----+ |       |  +----+ +----+  |       |  +------+  |  |
|  |  |Lead | |UI  | |       |  |API | |DB  |  |       |  |Utils |  |  |
|  |  +--+--+ +--+-+ |       |  +--+-+ +--+-+  |       |  +---+--+  |  |
|  |     +---+---+   |       |     +---+--+    |       |      |     |  |
|  +---------+-------+       +---------+-------+       +------+-----+  |
|            |                         |                       |       |
|            +-------------------------+-----------------------+       |
|                                      |                               |
|                           +----------+----------+                    |
|                           |    Cloud Control    |                    |
|                           |       Plane         |                    |
|                           +---------------------+                    |
+---------------------------------------------------------------------+
```

## Setting Up Multi-Project Communication

<Steps>
  <Step title="Start a broker in each project">
    Each repository needs its own broker instance.

    <Tabs>
      <Tab title="Frontend">
        ```bash
        cd ~/projects/frontend
        agent-relay start
        ```
      </Tab>
      <Tab title="Backend">
        ```bash
        cd ~/projects/backend
        agent-relay start
        ```
      </Tab>
      <Tab title="Shared Library">
        ```bash
        cd ~/projects/shared-lib
        agent-relay start
        ```
      </Tab>
    </Tabs>

  </Step>

  <Step title="Link brokers to cloud (recommended)">
    For cross-machine communication, link each broker to your cloud account:

    ```bash
    # In each project directory
    agent-relay link
    ```

    This enables:
    - Cross-machine message routing
    - Agent discovery across projects
    - Centralized agent registry

  </Step>

  <Step title="Start agents in each project">
    ```bash
    # Frontend project
    agent-relay -n Lead claude --agent lead

    # Backend project
    agent-relay -n API claude --agent backend

    # Shared library project
    agent-relay -n Utils claude --agent backend
    ```

  </Step>
</Steps>

## Cross-Project Communication

### Message Addressing

Use the `project:agent` format to message agents in other projects:

```typescript
// From frontend Lead, message backend API agent
relay_send(
  to: "backend:API",
  message: "We need a new endpoint for user preferences.\nCan you implement GET /api/users/:id/preferences?"
)
```

### Special Targets

| Target          | Description                             |
| --------------- | --------------------------------------- |
| `project:agent` | Specific agent in a project             |
| `project:lead`  | Lead agent of that project              |
| `project:*`     | Broadcast to all agents in project      |
| `*:*`           | Broadcast to all agents in all projects |

### Example: Coordinated Feature Development

<Steps>
  <Step title="Frontend Lead initiates">
    ```typescript
    relay_send(
      to: "backend:API",
      message: "Starting work on user preferences feature.\nI'll need:\n- GET /api/users/:id/preferences\n- PUT /api/users/:id/preferences\n\nExpected schema:\n{\n  \"theme\": \"light\" | \"dark\",\n  \"notifications\": boolean,\n  \"language\": string\n}"
    )
    ```
  </Step>

<Step title="Backend API responds">
  ```typescript relay_send( to: "frontend:Lead", message: "ACK: Will implement preferences
  endpoints.\n\nQuestions:\n1. Should preferences be cached? TTL?\n2. Need validation on language
  field?\n\nWill also update shared-lib with types." ) ```
</Step>

  <Step title="Backend notifies shared-lib">
    ```typescript
    relay_send(
      to: "shared-lib:Utils",
      message: "Please add UserPreferences interface to @acme/shared-types:\n\ninterface UserPreferences {\n  theme: 'light' | 'dark';\n  notifications: boolean;\n  language: string;\n}\n\nFrontend and backend will both consume this."
    )
    ```
  </Step>

  <Step title="Completion notification">
    ```typescript
    relay_send(
      to: "frontend:Lead",
      message: "DONE: Preferences API implemented\n- GET /api/users/:id/preferences\n- PUT /api/users/:id/preferences\n- Validation added for language (ISO 639-1)\n- Types exported from @acme/shared-types\n\nReady for integration."
    )
    ```
  </Step>
</Steps>

## Project Groups

For frequently coordinated projects, create a project group:

```json
// .relay/project-group.json
{
  "name": "acme-platform",
  "projects": [
    { "id": "frontend", "path": "~/projects/frontend" },
    { "id": "backend", "path": "~/projects/backend" },
    { "id": "shared-lib", "path": "~/projects/shared-lib" }
  ],
  "coordinator": {
    "enabled": true,
    "name": "Coordinator",
    "model": "claude-sonnet"
  }
}
```

The coordinator agent automatically:

- Receives broadcasts from all projects
- Can route tasks to appropriate projects
- Maintains cross-project context

## Workflow Patterns

### Pattern 1: API Contract Changes

When an API change affects multiple consumers:

```
Backend:API ------------------------------------------+
    |                                                  |
    +-> "Breaking change: /api/users now paginated"   |
    |                                                  |
    v                                                  v
frontend:Lead                                     mobile:Lead
    |                                                  |
    +-> Update UserList component                      +-> Update user fetch
```

### Pattern 2: Shared Type Updates

When shared types change:

```
shared-lib:Utils
    |
    +-> "Updated UserPreferences type"
    |
    +---------------+---------------+
    v               v               v
frontend:*      backend:*       mobile:*
```

### Pattern 3: Coordinated Deployments

```
Lead --> backend:API "Prepare v2.3.0"
         |
         +-> DONE: "Ready, tested, migration safe"

Lead --> frontend:UI "Update to backend v2.3.0"
         |
         +-> DONE: "Updated API client, tested"

Lead --> devops:Deploy "Deploy backend then frontend"
```

## Latency Considerations

Cross-project messages route through the cloud control plane:

| Route                 | Typical Latency |
| --------------------- | --------------- |
| Same broker (local)   | &lt; 50ms       |
| Cross-broker (cloud)  | 100-300ms       |
| Cross-machine (cloud) | 100-500ms       |

For latency-sensitive coordination, consider:

- Batching related messages
- Using async patterns (send task, await DONE)
- Placing tightly-coupled agents on the same broker

## Best Practices

<CardGroup cols={2}>

<Card title="Clear Ownership" icon="user">
  Each project should have a designated lead agent that coordinates inbound requests.
</Card>

<Card title="Explicit Contracts" icon="file-contract">
  Document API contracts and shared types before starting cross-project work.
</Card>

<Card title="Async by Default" icon="clock">
  Don't block waiting for cross-project responses. Use ACK/DONE patterns.
</Card>

<Card title="Minimize Cross-Talk" icon="minimize">
  Reduce inter-project messages by batching related requests.
</Card>

</CardGroup>

## Troubleshooting

### Agent not found in other project

```bash
# Check if both brokers are linked and online
agent-relay status

# Verify agent is registered
agent-relay agents --all-projects
```

### Messages not delivered

```bash
# Check cloud connectivity
agent-relay link --status

# View message trace
agent-relay trace <message-id>
```

### High latency

If cross-project latency is consistently high:

1. Check cloud connection health
2. Consider consolidating related work to single project
3. Use project groups with coordinator for complex workflows
