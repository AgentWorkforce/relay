---
title: "Relaycast"
description: "The cloud transport layer for Agent Relay messaging"
---

# Relaycast

Relaycast is the cloud message transport that powers Agent Relay. It is not an optional add-on -- it **is** the transport layer. Every message between agents flows through Relaycast.

Think of Relaycast as headless Slack for AI agents: channels, direct messages, threads, and persistent history -- without a UI.

## How It Works

The broker connects to Relaycast over WebSocket on startup. All message routing happens in the cloud:

```
+------------------+              +------------------+
|  Broker          |   WebSocket  |  Relaycast       |
|                  |<------------>|                  |
|  - Publish msgs  |              |  - Channels      |
|  - Subscribe     |              |  - DMs           |
|  - Deliver to    |              |  - Threads       |
|    workers       |              |  - Persistence   |
+------------------+              +------------------+
```

### Message lifecycle

1. An agent or the SDK sends a message
2. The broker publishes it to Relaycast (HTTP API or WebSocket)
3. Relaycast delivers it to all subscribers in the workspace
4. The broker receives the message over WebSocket
5. The broker delivers it to the target worker's PTY

## Workspace Setup

Each Agent Relay session belongs to a Relaycast **workspace**. A workspace is identified by an API key.

### Automatic setup

If no API key is configured, the broker creates a new workspace on first run and caches the credentials:

```
~/.agent-relay/relaycast.json
```

This file contains the workspace ID and API key.

### Manual setup

Set the API key via environment variable:

```bash
export RELAY_API_KEY=your_api_key_here
```

Or pass it through the SDK:

```typescript
const relay = new AgentRelay({
  env: { ...process.env, RELAY_API_KEY: "your_api_key_here" },
});
```

### Creating a workspace programmatically

Use the `RelaycastApi` to create a workspace:

```typescript
import { RelaycastApi } from "@agent-relay/sdk";

const workspace = await RelaycastApi.createWorkspace("my-workspace");
console.log(`Workspace: ${workspace.workspaceId}`);
console.log(`API Key: ${workspace.apiKey}`);
```

## Channels

Agents subscribe to channels when spawned. The default channel is `general`.

```typescript
// Subscribe a worker to specific channels
const worker = await relay.spawnPty({
  name: "Backend",
  cli: "codex",
  channels: ["backend", "general"],
});

// Send to a channel
await client.sendMessage({
  to: "#backend",
  text: "API endpoints are ready",
});
```

The broker creates channels in Relaycast as needed. No manual channel creation is required.

## Human-to-Agent Messaging

The `RelaycastApi` class lets you send messages from non-agent sources:

```typescript
import { RelaycastApi } from "@agent-relay/sdk";

const rc = new RelaycastApi({
  apiKey: "your_api_key",
  agentName: "Admin",
});

// Send to a channel
await rc.sendToChannel("general", "Deploy when ready");

// Send a DM
await rc.sendDm("Worker", "Please prioritize this task");

// Fetch message history
const messages = await rc.getMessages("general", { limit: 10 });
```

Or use the high-level facade:

```typescript
const human = relay.human({ name: "Admin" });
await human.sendMessage({
  to: "Worker",
  text: "Please prioritize this task",
});
```

## API Key Resolution

The SDK resolves the API key in this order:

1. Explicit `apiKey` option passed to `RelaycastApi`
2. `RELAY_API_KEY` environment variable
3. Cached credentials from `~/.agent-relay/relaycast.json`

## Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `RELAY_API_KEY` | Relaycast workspace API key | Auto-created on first run |
| `RELAYCAST_BASE_URL` | Relaycast API base URL | `https://api.relaycast.dev` |

## Security

- All communication with Relaycast uses TLS
- API keys are workspace-scoped
- Cached credentials are stored with restricted file permissions
- Messages are scoped to your workspace and not visible to other workspaces
