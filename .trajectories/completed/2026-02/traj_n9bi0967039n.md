# Trajectory: Systematically fix broker/dashboard relay messaging and registration issues

> **Status:** âœ… Completed
> **Confidence:** 88%
> **Started:** February 23, 2026 at 07:52 PM
> **Completed:** February 23, 2026 at 08:10 PM

---

## Summary

Fixed broker/dashboard/relaycast identity and delivery semantics: broker-first proxy send path, strict worker identity registration, no reinjection duplicates, delivery status propagation in UI, and log WS missing-file guard in proxy mode. Verified via cargo unit tests, dashboard+server full tests, relaycast mcp full tests, and relay-cli integration suite (17/17).

**Approach:** Standard approach

---

## Key Decisions

### Route all proxy-mode /api/send traffic through broker /api/send

- **Chose:** Route all proxy-mode /api/send traffic through broker /api/send
- **Reasoning:** Local spawned workers are broker-scoped and may not have Relaycast presence; broker is source-of-truth for local delivery and fallback publish.

### Disable PTY reinjection retries on echo-timeout

- **Chose:** Disable PTY reinjection retries on echo-timeout
- **Reasoning:** Echo matching is noisy and reinjection duplicates messages, causing repeated reminders and Relaycast rate-limit amplification.

---

## Chapters

### 1. Work

_Agent: default_

- Route all proxy-mode /api/send traffic through broker /api/send: Route all proxy-mode /api/send traffic through broker /api/send
- Disable PTY reinjection retries on echo-timeout: Disable PTY reinjection retries on echo-timeout
